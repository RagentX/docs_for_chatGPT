<!DOCTYPE html>
<html>
<head>
   <title>Сервис интеграции с почтой России</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=Windows-1251" />   
   
   <meta http-equiv="X-UA-Compatible" content="IE=edge" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <link type="text/css" href="custom.css" rel="stylesheet">

   <style TYPE="text/css" media="screen"> 
      html, body { margin:0; 
             padding:0; 
             overflow: hidden; 
             background: #FFFFFF; 
       } 

      div#printheader { display: none; }
      #idheader { width:100%; 
                  height:auto; 
                  padding: 0; 
                  margin: 0; 
       } 
      #idcontent { position:relative }                                               
      #callout-table, #overview-table {display:block; position:relative; top:0; left:0;}
      #callout-icon {display:block; position:absolute; top:-11px; left:-11px;}
      #callout-icon-flag {display:block; position:absolute; top:-11px; left:-8px;}
      #callout-table a {text-decoration: none; color: blue;}
      #callout-table a:visited {text-decoration: none; color: blue;}
      #overview-table a {text-decoration: none; color: black;}
      #overview-table a:visited {text-decoration: none; color: black;}
      #callout-table a:hover, #overview-table a:hover {text-decoration: underline;}      
      #switchtoggles { text-align: right; padding: 0 5px 0 0; font-size: 90%; margin: 0; }  
      p.help-url { margin: 20px 0 5px 0; text-align: center; font-size: 80%; text-decoration: none }
      .sync-toc { color: #ffffff; font-size: 8pt; font-weight: bold; display: none; }
      .sync-toc a { color: #ffffff; text-decoration: none; font-weight: bold;}
      .sync-toc a:visited { color: #ffffff; }
      .sync-toc a:hover { text-decoration: underline; }

   </style>
   <noscript>
   <style type="text/css">
   html, body { overflow: auto; }
   </style> 
   </noscript>
   <style type="text/css" media="print">
      span.f_Heading1 { color: black; }
      #idheader, #printheader img { display:none; }
      #printheader { display: block; margin-top: 20px; }
      #idcontent { margin-top: 10px; position:relative }
   </style>   

   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>
   <script type="text/javascript" src="nsh.js"></script>
<!--[if lt IE 7]>
<style type="text/css">
  #idcontent {padding: 0px;} 
  #innerdiv {padding: 10px 5px 5px 10px ;} 
</style> 
<![endif]-->



</head>
<body>


<div id="printheader"><h1 class="p_Heading1"><span class="f_Heading1">Сервис интеграции с почтой России</span></h1>
</div>
<div id="idheader">
<div id="idheaderbg">
<table style="width:100%;border:none;margin:0px;background:url(background-topic-header.jpg)" cellspacing="0" cellpadding="0"> 
  <tr valign="bottom">
    <td align="left" valign="bottom" class="topichead">
   
   <p class="crumbs" id="idnav"><b>Navigation:</b>&nbsp;
   
   <a href="functions.htm">Функциональные возможности</a>&nbsp;&gt;</p>
   <h1 class="p_Heading1"><span class="f_Heading1">Сервис интеграции с почтой России</span></h1>

    </td>
    <td align="right" width="120" valign="middle" class="topichead" id="idnav">
    
     <a href="features_add_documents_to_objects.htm"
        onmouseover="document.images.prev.src='hm_btn_navigate_prev_orange.png'" 
        onmouseout="document.images.prev.src='hm_btn_navigate_prev.png'"
        ><img name="prev" src="hm_btn_navigate_prev.png" border=0 alt="Previous page"
        ></a><a href="functions.htm"
        onmouseover="document.images.main.src='hm_btn_navigate_top_orange.png'" 
        onmouseout="document.images.main.src='hm_btn_navigate_top.png'"><img name=main src="hm_btn_navigate_top.png" border=0 alt="Return to chapter overview"
        ></a><a href="using_of_substatus_ep.htm"
        onmouseover="document.images.next.src='hm_btn_navigate_next_orange.png'" 
        onmouseout="document.images.next.src='hm_btn_navigate_next.png'"><img name=next src="hm_btn_navigate_next.png" border=0 alt="Next page"
        ></a>
    </td>
  </tr>  
</table>
<!-- The following code displays Expand All/Collapse All links  below the header in topics containing toggles -->
  
</div>
</div>  

<div id="idcontent"><div id="innerdiv">
<!--ZOOMRESTART-->
<p class="p_BodyText"><img alt="примечание_white" style="margin:0;width:0.1458in;height:0.1979in;border:none" src="hmfile_hash_17d6ccb8.png"/><span class="f_BodyText"> </span><span class="f_Кнопкакурсив">Примечание</span><span class="f_Emphasis">. Данный функционал включается по согласованию с вендором. Обратитесь в техническую поддержку</span><span class="f_BodyText">.</span><span class="f_BodyText" style="background-color: #ebf2de;">&nbsp;Коммерческая константа&nbsp;</span><span style="background-color: #ebf2de;">@PostRussia.Use</span><span class="f_BodyText" style="background-color: #ebf2de;">.</span></p>
<p class="p_BodyText"><span class="f_BodyText">Сервис интеграции с почтой России используется для интеграции с «ПОЧТА РОССИИ» через API отслеживания почтовых отправлений.</span></p>
<p class="p_BodyText"><span class="f_BodyText">В сервисе поддержана отправка двух типов запросов:</span></p>
<p class="p_ListBullet2" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.2500in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet2"><a href="service_post_russia_integration.htm#service_post_russia_integration_1" class="topiclink">Запрос билета на подготовку информации, содержащий список идентификаторов отправлений</a>.</span></p><p class="p_ListBullet2" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.2500in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet2"><a href="service_post_russia_integration.htm#service_post_russia_integration_2" class="topiclink">Запрос на получение готового ответа по билету</a>.</span></p><p class="p_heading5" style="page-break-after: avoid;"><span class="f_heading5">Файл конфигурации</span></p>
<p class="p_BodyText"><span class="f_BodyText">В файле конфигурации сервиса поддержана настройка следующих параметров:</span></p>
<p class="p_ListBullet2" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.2500in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet2">login — Логин для доступа к API Сервиса отслеживания;</span></p><p class="p_ListBullet2" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.2500in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet2">password — Пароль для доступа к API Сервиса отслеживания;</span></p><p class="p_ListBullet2" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.2500in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet2">language — Язык, используемый в ответных сообщениях. Возможные значения: RUS, ENG;</span></p><p class="p_ListBullet2" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.2500in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet2">request_rate — частота запросов в минутах на создание заявки и получение информации по потенциально «готовой» заявке;</span></p><p class="p_ListBullet2" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.2500in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet2">get_info_request_interval — интервал в минутах между попытками получить информацию по заявке;</span></p><p class="p_ListBullet2" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.2500in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet2">max_letter_amount_in_package — максимально допустимое количество писем в одном пакете;</span></p><p class="p_ListBullet2" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.2500in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet2">ticket_storage_time — время хранения ответа по билету в часах (время, в течение которого есть возможность запрашивать информацию по билету);</span></p><p class="p_ListBullet2" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.2500in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet2">letter_selection_restriction — ограничения при отборе писем, по которым требуется получить информацию. В скобках указывается диапазон в днях с момента отправки и через двоеточие периодичность, с которой требуется отбирать письма для получения информации;</span></p><p class="p_ListBullet2" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.2500in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet2">email_user_group_id — идентификатор группы пользователей, на email которых делается рассылка о непредвиденном статусе.</span></p><p class="p_BodyText"><span class="f_BodyText">Например, значение (0-365:1)(366-730:7) означает, что:</span></p>
<p class="p_ListBullet2" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.2500in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet2">запросы по письмам, с момента отправки которых прошло не более года, делаются ежедневно;</span></p><p class="p_ListBullet2" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.2500in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet2">запросы по письмам, с момента отправки которых прошло от 1 до 2 лет, делаются еженедельно;</span></p><p class="p_ListBullet2" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.2500in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet2">запросы по письмам, с момента отправки которых прошло более 2 лет, не делаются.</span></p><p class="p_heading5" style="page-break-after: avoid;"><a name="service_post_russia_integration_1" class="hmanchor"></a><span class="f_heading5">Запрос билета на подготовку информации</span></p>
<p class="p_BodyText"><span class="f_BodyText">Сервис ежедневно, в соответствии с частотой, указанной в параметре конфигурации «request_rate», выполняет запрос на подготовку информации по отобранным письмам (трек-номерам).</span></p>
<p class="p_heading6" style="page-break-after: avoid;"><span class="f_heading6">Алгоритм запроса на подготовку информации</span></p>
<p class="p_ListNumber" style="text-indent: 0; padding-left: 0.2500in; margin-left: 0;"><span class="f_ListNumber" style="display:inline-block;width:0.2500in;margin-left:-0.2500in">1.</span><span class="f_ListNumber">Отбираются письма. Для этого берутся записи таблицы, хранящей письма и их статусы, для которых выполняются следующие условия:</span></p><p class="p_ListBullet2" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.2500in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet2">letter_track_number is not null и при этом состоит из 14 цифр;</span></p><p class="p_ListBullet2" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.2500in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet2">letter_status is NULL ИЛИ запись таблицы post_russia_status, для которой post_russia_status.composite_code=letter_status, имеет неконечный статус (post_russia_status.is_finish&lt;&gt;1);</span></p><p class="p_ListBullet2" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.2500in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet2">с момента post_russia_letter.letter_track_number_dt прошло количество дней, попадающее в один из диапазонов, настроенных в параметре letter_selection_restriction, и при этом с момента обновления статуса post_russia_letter.letter_status_dt прошло больше дней, чем количество, поставленное в соответствие диапазону;</span></p><p class="p_ListBullet2" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.2500in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet2">в таблице post_russia_active_request нет записей, для которых:</span></p><p class="p_ListBullet3" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.5000in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet3">post_russia_active_request.obj_id=post_russia_letter.obj_id;</span></p><p class="p_ListBullet3" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.5000in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet3">post_russia_active_request.r_id=post_russia_letter.r_id;</span></p><p class="p_ListBullet2" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.2500in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet2">в первую очередь отбираются записи с меньшим значением post_russia_letter.letter_track_number_dt.</span></p><p class="p_ListNumber" style="text-indent: 0; padding-left: 0.2500in; margin-left: 0;"><span class="f_ListNumber" style="display:inline-block;width:0.2500in;margin-left:-0.2500in">2.</span><span class="f_ListNumber">Отобранные записи делятся на пачки по N штук, где N - количество, не превышающее значение, указанное в параметре файла конфигурации max_letter_amount_in_package.</span></p><p class="p_ListNumber" style="text-indent: 0; padding-left: 0.2500in; margin-left: 0;"><span class="f_ListNumber" style="display:inline-block;width:0.2500in;margin-left:-0.2500in">3.</span><span class="f_ListNumber">Для каждой такой пачки выполняются следующие действия:</span></p><p class="p_ListBullet2" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.2500in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet2">Формируется запрос на получение номера заявки.</span></p><p class="p_ListBullet2" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.2500in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet2">Обрабатывается полученный ответ.</span></p><p class="p_ListBullet2" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.2500in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet2">Если в ответе успешно получен номер созданной заявки, то:</span></p><p class="p_ListBullet3" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.5000in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet3">В таблицу, хранящую билеты, добавляется соответствующая новая запись.</span></p><p class="p_ListBullet3" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.5000in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet3">В таблицу, хранящую запросы, добавляется соответствующая новая запись для каждого письма, по которому был отправлен запрос.</span></p><p class="p_ListBullet2" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.2500in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet2">В случае если получить номер заявки не удалось, полученная ошибка записывается в логи сервиса. Записи в таблицы при этом не добавляются.</span></p><p class="p_heading5" style="page-break-after: avoid;"><a name="service_post_russia_integration_2" class="hmanchor"></a><span class="f_heading5">Запрос на получение готового ответа по билету</span></p>
<p class="p_BodyText"><span class="f_BodyText">Сразу после выполнения запросов на создание заявки сервис выполняет запросы на получение информации по письмам.</span></p>
<p class="p_heading6" style="page-break-after: avoid;"><span class="f_heading6">Алгоритм запроса на получение готового ответа по билету</span></p>
<p class="p_ListNumber" style="text-indent: 0; padding-left: 0.2500in; margin-left: 0;"><span class="f_ListNumber" style="display:inline-block;width:0.2500in;margin-left:-0.2500in">1.</span><span class="f_ListNumber">Из таблицы, хранящей билеты, удаляются записи, для которых с момента создания прошло больше часов, чем указано в значении параметра конфигурации «ticket_storage_time». Также удаляются все связанные записи из таблицы, хранящей запросы.</span></p><p class="p_ListNumber" style="text-indent: 0; padding-left: 0.2500in; margin-left: 0;"><span class="f_ListNumber" style="display:inline-block;width:0.2500in;margin-left:-0.2500in">2.</span><span class="f_ListNumber">Из оставшихся записей таблицы, хранящей билеты, отбираются записи, для которых с момента последнего запроса информации по заявке прошло больше минут, чем указано в значении параметра конфигурации «get_info_request_interval» (если дата последнего запроса пуста, то смотрим с момента создания билета).</span></p><p class="p_ListNumber" style="text-indent: 0; padding-left: 0.2500in; margin-left: 0;"><span class="f_ListNumber" style="display:inline-block;width:0.2500in;margin-left:-0.2500in">3.</span><span class="f_ListNumber">Отобранные записи упорядочиваются по дате последнего запроса от меньшего значения к большему, т.е. сначала идут записи, по которым большее время не делали запрос на получение информации. Поочередно для каждой записи:</span></p><p class="p_ListBullet2" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.2500in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet2">Формируется запрос на получение информации по билету.</span></p><p class="p_ListBullet2" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.2500in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet2">Обрабатывается полученный ответ.</span></p><p class="p_ListBullet2" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.2500in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet2">Если получена информация по письмам, то для каждой связанной записи по запросу обрабатывается информация, полученная по соответствующему треку. Для этого:</span></p><p class="p_ListBullet3" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.5000in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet3">из таблицы, хранящей операции, удаляются записи о предыдущих операциях;</span></p><p class="p_ListBullet3" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.5000in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet3">в таблицу, хранящую операции, добавляются актуальные записи;</span></p><p class="p_ListBullet3" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.5000in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet3">Если по письму получена ошибка, требуется добавляется запись, включающая код ошибки. Также полученная ошибка записывается в логи сервиса.</span></p><p class="p_ListBullet3" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.5000in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet3">Если трек-номер, информацию по которому запрашивали, совпадает с текущим значением трек-номера, то обновляется запись в таблице, хранящей письма и их статусы.</span></p><p class="p_ListBullet3" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.5000in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet3">Если был получен хотя бы непредвиденный статус (он отсутствует в таблице, хранящей список статусов), то после обработки всех записей (после получения ответа по всем письмам) выполняется email-рассылка группе пользователей, указанной в параметре конфигурации «email_user_group_id» на настроенный ящик со следующим текстом:</span></p><p class="p_quote_my" style="border-top: none; border-right: none; border-bottom: none;"><span class="f_quote_my">От почты России получен непредвиденный статус: %value</span></p>
<p class="p_quote_my" style="border-top: none; border-right: none; border-bottom: none;"><span class="f_quote_my">Все возможные статусы можно посмотреть по https://tracking.pochta.ru/support/dictionaries/operation_codes</span></p>
<p class="p_BodyText"><span class="f_BodyText">где %value - &nbsp;все различные полученные непредвиденные статусы.</span></p>
<p class="p_ListBullet3" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.5000in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet3">Иначе статус в таблице, хранящей письма и их статусы, не обновляется. В лог сервиса записывается ошибка:</span></p><p class="p_quote_my" style="border-top: none; border-right: none; border-bottom: none;"><span class="f_quote_my">«Текущее значение трек-номера &nbsp;%post_russia_letter.letter_track_number% не совпадает с трек-номером %post_russia_active_request.letter_track_number%, по которому делался запрос. Статус письма не будет обновлен»</span></p>
<p class="p_BodyText"><span class="f_BodyText">После загрузки информации по билету удаляется запись в таблице, хранящей билеты, по которой делался запрос на получение ответа, а также удалить все связанные записи в таблице, хранящей запросы.</span></p>
<p class="p_ListBullet2" style="text-indent: 0; padding-left: 0.2396in; margin-left: 0.2500in;"><span style="display:inline-block;width:0.2396in;margin-left:-0.2396in;font-size:10pt;font-family:'Symbol';font-style:normal;color:#000000;text-decoration:none;">&#183;</span><span class="f_ListBullet2">Иначе полученная ошибка записывается в логи сервиса, и значение даты последнего запроса информации по заявке в таблице, хранящей билеты, обновляется текущей датой временем.</span></p>
<!--ZOOMSTOP-->
</div></div>
<script type="text/javascript">

var lastSlashPos = document.URL.lastIndexOf("/") > document.URL.lastIndexOf("\\") ? document.URL.lastIndexOf("/") : document.URL.lastIndexOf("\\");
if( document.URL.substring(lastSlashPos + 1, lastSlashPos + 4).toLowerCase() != "~hh" )
{
 if (document.all) setTimeout(function() {nsrInit();},20); 
    else nsrInit();
 } 


</script>
</body>
</html>
